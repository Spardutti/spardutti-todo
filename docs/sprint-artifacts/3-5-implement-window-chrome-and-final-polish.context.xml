<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>3</epicId>
    <storyId>5</storyId>
    <title>Implement Window Chrome and Final Polish</title>
    <status>drafted</status>
    <generatedAt>2025-11-23</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/3-5-implement-window-chrome-and-final-polish.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>a user</asA>
    <iWant>the application window to have minimal chrome with proper spacing</iWant>
    <soThat>the interface is distraction-free and professional</soThat>
    <tasks>
- [ ] Add app container layout styles (AC: #1)
  - [ ] Locate #app container selector in styles.css (or create LAYOUT section)
  - [ ] Set `display: flex` and `flex-direction: column`
  - [ ] Set `height: 100vh` (full viewport)
  - [ ] Set `padding: 16px` (edge breathing room)
  - [ ] Set `background: var(--color-bg-primary)` (#000000)
  - [ ] Set `box-sizing: border-box` (include padding in height)
  - [ ] Verify layout renders correctly with existing components

- [ ] Configure vertical spacing hierarchy (AC: #2)
  - [ ] Verify input field is first child of #app (no margin-top needed)
  - [ ] Check todo list has `margin-top: 0.75rem` (gap from input)
  - [ ] Set todo list `flex-grow: 1` (fills available space)
  - [ ] Set todo list `overflow-y: auto` (scrollable if content exceeds height)
  - [ ] Verify footer margin-top (0.75rem from Story 3.4) creates gap
  - [ ] Test vertical layout with 0, 10, and 50 todos

- [ ] Remove any remaining browser default styles (AC: #3)
  - [ ] Audit styles.css for any missed default browser styles
  - [ ] Check for unwanted margins/padding on body, html, or #app
  - [ ] Verify no default focus outlines except input (input focus glow is intentional)
  - [ ] Remove any default list styles (bullets) - should already be done in Story 3.3
  - [ ] Ensure no default button styles if buttons exist

- [ ] Verify minimal chrome checklist (AC: #3)
  - [ ] Use DevTools Elements inspector to search styles.css
  - [ ] Search for `gradient` (linear-gradient, radial-gradient) → Expect 0 matches
  - [ ] Search for `box-shadow` → Expect exactly 1 match (input focus)
  - [ ] Search for `border-radius` → Expect 0 matches
  - [ ] Search for `background-image` → Expect 0 matches
  - [ ] Visual inspection: Only black background, no textures

- [ ] Verify scrollbar behavior (AC: #4)
  - [ ] Add 20+ todos to trigger scrollbar appearance
  - [ ] Verify scrollbar appears on todo list container (not window)
  - [ ] Confirm OS native scrollbar styling (no custom colors/width)
  - [ ] Check styles.css for `::-webkit-scrollbar` selectors → Expect 0 matches
  - [ ] Test scrolling performance (smooth, no jank)

- [ ] Validate terminal aesthetic enforcement (AC: #5)
  - [ ] Font audit (all text uses Consolas monospace, body: 14px, footer: 12px)
  - [ ] Color audit (background #000000, active #00FF00, completed #004400, footer #008800)
  - [ ] Animation audit: `grep -E "(transition|animation|@keyframes)" src/ui/styles.css` → Expect exit code 1
  - [ ] Spacing audit (item padding 0.35rem, app padding 16px, gaps 0.75rem)

- [ ] Final visual QA and polish (AC: #6)
  - [ ] Launch app: `npm start`
  - [ ] Visual inspection checklist (clean, terminal aesthetic, aligned, no glitches)
  - [ ] User flow testing (type todo, toggle, add many, resize window)

- [ ] Cross-reference with UX spec final checklist

- [ ] Automated validation

- [ ] Edge case testing (resize, empty list, long text)</tasks>
  </story>

  <acceptanceCriteria>
1. **Main app container has proper flexbox layout and dimensions**
   - Padding: 16px, Display: flex, Flex-direction: column, Height: 100vh, Background: #000000, Box-sizing: border-box

2. **Vertical spacing creates clear visual hierarchy**
   - Input at top → Gap: 0.75rem → Todo list (flex-grow: 1, scrollable) → Gap: 0.75rem → Footer at bottom

3. **Window has no unnecessary UI chrome**
   - No decorative borders, box-shadows (except input focus), gradients, textures, colored backgrounds, border-radius

4. **Scrollbar uses OS defaults without custom styling**
   - No custom scrollbar styling, OS native appearance

5. **Entire UI follows terminal aesthetic constraints**
   - Monospace font (Consolas 14px), Matrix Green palette, no animations, sharp corners, dense layout

6. **Application appears professional and focused**
   - Clean, terminal aesthetic, fast, aligned, zero distractions</acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>Visual Foundation - Spacing & Layout System</section>
        <snippet>Base Unit: 8px spacing scale. Window padding: 16px (breathing room), Input field padding: 8px, Todo item padding: 8px vertical, Footer margin-top: 16px. Dense information layout chosen for maximum todos visible without scrolling.</snippet>
      </doc>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>Design Direction - Dense Information Layout</section>
        <snippet>Input at top (traditional terminal), single-column list structure, tight vertical spacing (0.35rem padding), minimal gaps (0.75rem major sections), thin borders (1px), maximum information density for power users.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture</title>
        <section>Terminal Aesthetic Enforcement</section>
        <snippet>Font: Consolas monospace 14px (no exceptions). Colors: Matrix Green ONLY (#00FF00, #004400, #008800, #000000, #FF0000). No animations/transitions. No box-shadows except input focus glow (0 0 8px #00FF00). Borders: 1px solid green, no border-radius. Background: pure black #000000.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-3.md</path>
        <title>Epic 3 Technical Specification</title>
        <section>Layout Specification</section>
        <snippet>App container: display flex, flex-direction column, height 100vh, padding 16px, background #000000, box-sizing border-box. Vertical hierarchy: Input → 0.75rem gap → List (flex-grow 1, overflow-y auto) → 0.75rem gap → Footer (fixed via flexbox).</snippet>
      </doc>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>FR30 - Minimal Distraction-Free UI</section>
        <snippet>The application window is minimal and distraction-free (no unnecessary UI chrome). Part of User Interface requirements ensuring ultra-fast task capture without visual noise.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>src/ui/styles.css</path>
        <kind>stylesheet</kind>
        <symbol>CSS styles</symbol>
        <lines>complete file</lines>
        <reason>Main stylesheet containing all Epic 3 styling including color system, input, list, footer styles from Stories 3.1-3.4. Story 3.5 adds final LAYOUT & APP CONTAINER section.</reason>
      </artifact>
      <artifact>
        <path>src/ui/render.ts</path>
        <kind>renderer</kind>
        <symbol>renderApp, renderTodoList</symbol>
        <lines>complete file</lines>
        <reason>Creates DOM structure (#app container, input, list, footer) that CSS in Story 3.5 will style. No changes to render.ts expected - only CSS additions.</reason>
      </artifact>
      <artifact>
        <path>index.html</path>
        <kind>html</kind>
        <symbol>HTML shell</symbol>
        <lines>complete file</lines>
        <reason>Loads styles.css and defines #app root container. Verify structure matches expected flexbox parent for Story 3.5 layout.</reason>
      </artifact>
    </code>
    <dependencies>
      <node>
        <package>electron</package>
        <version>39.2.3</version>
        <purpose>Desktop application framework, renders Chromium with CSS support for terminal aesthetic</purpose>
      </node>
      <node>
        <package>vite</package>
        <version>5.4.21</version>
        <purpose>Build tool, bundles styles.css with renderer process</purpose>
      </node>
      <node>
        <package>typescript</package>
        <version>5.9.2</version>
        <purpose>Type safety (no direct impact on CSS-only Story 3.5)</purpose>
      </node>
    </dependencies>
  </artifacts>

  <constraints>
**Terminal Aesthetic Constraints (Architecture-Enforced):**
- Font: Consolas monospace 14px (body), 12px (footer hints) - NO exceptions or variations
- Colors: Matrix Green palette ONLY - #00FF00 (primary), #004400 (completed), #008800 (dimmed), #000000 (background), #FF0000 (error)
- No animations or transitions - all state changes instant (<16ms single frame)
- No box-shadows except input focus glow (0 0 8px #00FF00)
- Borders: 1px solid green (#00FF00), NO border-radius (sharp corners)
- Background: pure black #000000 only, NO gradients/textures/images

**CSS Organization (from Stories 3.1-3.4):**
- Section 1: COLOR SYSTEM & GLOBALS (Story 3.1)
- Section 2: INPUT FIELD (Story 3.2)
- Section 3: TODO LIST & ITEMS (Story 3.3)
- Section 4: FOOTER HINTS (Story 3.4)
- Section 5: LAYOUT & APP CONTAINER (Story 3.5 - ADD HERE)

**Development Constraints:**
- Pure CSS only (no preprocessor SASS/LESS/PostCSS)
- No JavaScript changes - CSS-only story
- DOM structure from Epic 2 unchanged (render.ts output)
- File size target: <10KB total styles.css (current ~4-5KB, Story 3.5 adds ~0.5KB)
- Required CSS selectors: #app, #todo-input, #todo-list, #footer-hints
- No custom scrollbar styling (use OS defaults per AC-4)</constraints>

  <interfaces>
**CSS Selectors (from render.ts DOM structure):**
- `#app` - Main application container (Story 3.5 target)
- `#todo-input` - Input field (styled in Story 3.2)
- `#todo-list` - Todo list container (styled in Story 3.3, needs flex-grow in Story 3.5)
- `.todo-item` - Individual todo items (styled in Story 3.3)
- `#footer-hints` - Footer (styled in Story 3.4, needs margin-top coordination)

**Expected DOM Structure (from Epic 2):**
```html
<div id="app">
  <input type="text" id="todo-input" placeholder="Type todo and press Enter..." />
  <ul id="todo-list">
    <li class="todo-item">...</li>
  </ul>
  <footer id="footer-hints">Enter: Save | Space: Toggle | Esc: Close</footer>
</div>
```

**CSS Custom Properties (from Story 3.1):**
```css
:root {
  --color-bg-primary: #000000;
  --color-text-primary: #00FF00;
  --color-text-secondary: #008800;
  --color-text-completed: #004400;
  --color-border-default: #00FF00;
  --color-error: #FF0000;
}
```

**Flexbox Layout Interface:**
- #app: Parent flex container (column direction, 100vh height)
- #todo-input: Flex child (no flex-grow, natural height)
- #todo-list: Flex child (flex-grow: 1, fills remaining space, scrollable)
- #footer-hints: Flex child (no flex-grow, natural height, stays at bottom)</interfaces>

  <tests>
    <standards>Epic 3 uses manual visual inspection as primary test approach (CSS styling is inherently visual). Automated validation via grep for forbidden CSS properties. Chrome DevTools for computed styles verification. No unit tests for CSS - visual QA against UX specification.</standards>
    <locations>No test files for CSS-only Epic 3. Testing is manual via `npm start` and DevTools inspection.</locations>
    <ideas>
      <idea ac="1">Test: Launch app, inspect #app element in DevTools, verify Computed Styles show: display: flex, flex-direction: column, height: 100vh (or viewport height in px), padding: 16px on all sides, background-color: rgb(0, 0, 0), box-sizing: border-box</idea>
      <idea ac="2">Test: Add 5, 10, 20 todos, verify vertical spacing: input at top, 0.75rem gap visible, list grows to fill space with scroll if needed, footer stays at bottom with 0.75rem gap above</idea>
      <idea ac="3">Test: DevTools search styles.css for forbidden keywords: grep "linear-gradient\|radial-gradient" (expect 0), grep "box-shadow" (expect 1 - input focus), grep "border-radius" (expect 0), grep "background-image" (expect 0), visual check: only black background</idea>
      <idea ac="4">Test: Add 25+ todos to trigger scroll, verify scrollbar appears on #todo-list (not window), check Computed Styles for ::-webkit-scrollbar rules (expect none), confirm OS native scrollbar (Windows default appearance)</idea>
      <idea ac="5">Test: Automated grep -E "(transition|animation|@keyframes)" src/ui/styles.css (expect exit code 1 = no matches). Manual DevTools audit: font-family Consolas throughout, all colors from Matrix Green palette, no font-weight variations</idea>
      <idea ac="6">Test: Complete user flow - launch app, type 3 todos, toggle one complete, add 20 more todos, resize window (horizontal and minimum 400×300px), verify layout remains intact, all elements visible and aligned, fast responsive interaction</idea>
      <idea ac="edge-case">Test empty todo list: verify input and footer still properly spaced. Test single todo: verify layout correct. Test very long todo (200+ chars): verify text wraps, no horizontal overflow. Test window resize to minimum (400×300px): all elements visible and usable</idea>
    </ideas>
  </tests>
</story-context>
